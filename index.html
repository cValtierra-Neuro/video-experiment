<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Rating Experiment</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
    #ratingForm { display: none; margin-top: 20px; }
    label, select, button { font-size: 1.2em; margin: 10px; }
    video { width: 80%; max-width: 800px; }
    #log { margin-top: 30px; font-size: 0.9em; white-space: pre-wrap; text-align: left; }
  </style>
</head>
<body>



############# 


#             TO DOs:  (1) Insert a page that records PIDs 
#                      (2) need to create a page that displays the instructions for the task. 
#                      (3) export responses as csv file to designated google drive 
#                       ** Also consider (a) forcing full screen w/ esc key, (b) disabling the mouse cursor, (c) a warning or something if participant navigates away  ;) 




  <h1>Video Experience Rating</h1>
  <p>Press the spacebar to pause the video and rate your experience.</p>
  <p>Press the spacebar again to continue watching.</p>

  <h2>Instructions</h2>
  <p>In this experiment, you will watch a video and provide ratings of your experience at various points. Press the spacebar to pause the video and rate how you are feeling at that moment. After submitting your rating, the video will resume.</p>
  <p>Use the following scale to rate your experience:</p>
  <ul>
    <li>1 - Very Negative</li>
    <li>2 - Negative</li>
    <li>3 - Neutral</li>
    <li>4 - Positive</li>
    <li>5 - Very Positive</li>
  </ul>
  <p>Press the spacebar to start the video.</p>
  <p>Press the spacebar to pause the video and rate your experience.</p>
  <p>Press the spacebar again to continue watching.</p>
###########
  <h1>!!Video Experience Rating Skeleton!!</h1>
  <video id="videoPlayer" controls>
    <source src="https://www.dropbox.com/scl/fi/y9celgwtby8447xv44jf3/stimulus2.mp4?rlkey=eubowr9pir2viwuan0krjessz&st=9axydcfk&raw=1" type="video/mp4"> #Ernesto hoost tutorial video: https://www.dropbox.com/scl/fi/b61cmafka2xne79jrwg1f/stimulus.mp4?rlkey=no1i84sd4dmv1rn4f40zka21l&st=jkcr3uas&raw=1
    Your browser does not support the video tag.
  </video>

  <div id="ratingForm">
    <p>How are you feeling right now?</p>
    <select id="rating">
      <option value="" disabled selected>Select a rating</option>
      <option value="1">1 - Very Negative</option>
      <option value="2">2 - Negative</option>
      <option value="3">3 - Neutral</option>
      <option value="4">4 - Positive</option>
      <option value="5">5 - Very Positive</option>
    </select><br>
    <button onclick="submitRating()">Submit</button>
  </div>

  <div id="log"></div>

  <script>
    const video = document.getElementById("videoPlayer");
    const form = document.getElementById("ratingForm");
    const ratingSelect = document.getElementById("rating");
    const logDiv = document.getElementById("log");

    let dataLog = [];

    document.body.addEventListener("keydown", (e) => {
      if (e.code === "Space" && !form.style.display.includes("block")) {
        e.preventDefault();
        pauseAndPrompt();
      }
    });

    function pauseAndPrompt() {
      video.pause();
      form.style.display = "block";
      ratingSelect.value = ""; // reset
    }

    function submitRating() {
      const rating = ratingSelect.value;
      if (!rating) {
        alert("Please select a rating.");
        return;
      }

      const currentTime = video.currentTime.toFixed(2);
      dataLog.push({ time: currentTime, rating: rating });

      updateLog();

      form.style.display = "none";
      video.play();
    }

    function updateLog() {
      let text = "Rating Log:\n";
      dataLog.forEach((entry, i) => {
        text += `#${i + 1} â€” Time: ${entry.time}s | Rating: ${entry.rating}\n`;
      });
      logDiv.textContent = text;
    }
  </script>

</body>
</html>
